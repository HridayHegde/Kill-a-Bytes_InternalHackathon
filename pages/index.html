<!doctype html>
<html lang="en">
<script>
    var sessionidgen = Math.random(0,9999);
    localStorage.setItem("session", sessionidgen);
</script>
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/style.css">
    <title>Kil-A-Bytes Crime Reporter</title>
    
    <script>
    var sessionid = localStorage.getItem("session");
   
        function send(text) {
            var resp = "";

            var settings = {
                "url": "https://kab2020-crimereg.herokuapp.com/communicate",
                "method": "POST",
                "timeout": 0,
                "headers": {
                    "Content-Type": "application/json"
            },
                "data": JSON.stringify({"session":sessionid,"text":text}),
            };
            
            $.ajax(settings).done(function (response) {
                console.log(response);
                resp1 = JSON.stringify(response);
                responsejson = JSON.parse(resp1);
                console.log(responsejson.text);
                $('.andu').attr('id',responsejson.text);
                
            });
           /* $.ajax({
                url : "https://kab2020-crimereg.herokuapp.com/communicate",
                method: "POST",
                dataType:'json',
                data: JSON.stringify({"session":sessionid,"text":text}),
                contentType: "application/json",
                success: function(data){
                    alert(data.d);
                    resp1 = JSON.stringify(data.d);
                    responsejson = JSON.parse(resp1);
                    resp = responsejson.text;
                },
                error:function(ex){
                    alert(ex.responseText);
                }

            });*/
            resp = $('.andu').attr('id');
            alert("afjnansf3j -- "+ resp);
            return resp;
            
          

    }
    </script>

</head>

<body>
    <div class="container andu">
        <br>

        <font class="main-heading">Kil-A-Bytes </font>
        <font class="presents">presents</font> <br>
        <font class="purple-heading">Crime Registeration Chatbot</font>
        <div class="container chat-window" style="background-color: #EEEFFF; border-radius: 12px;">
            <br>
            <div class="row bot-says">

                <div class="col-sm-1"><img src="../assets/chat_bot.svg" alt="" style="width: 45px;float: right;"></div>
                <div class="col-sm-5" style="background-color: #727AFF;border-radius: 12px;color: white;">

                    <p style="margin-top: 4px;"> Hi there, you can choose</p>


                </div>
                <div class="col-sm-6"></div>

                <br>
            </div>
            <br>
            <!--CARD SECTION STARTS HERE-->


            <div class="row">
                <div class="col-sm-1"></div>
                <div class="col-sm-6">
                    <div class="card">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-sm-6 "><button type="button" class="btn btn-primary">Log In</button></div>
                                <div class="col-sm-6 menu"><button type="button" class="btn btn-primary">Report Crime</button></div>

                            </div>
                            <br>
                            <div class="row">
                                <div class="col-sm-6 "><button type="button" class="btn btn-primary">Awareness</button></div>
                                <div class="col-sm-6 menu"><button type="button" class="btn btn-primary">Customer Support</button></div>

                            </div>
                            <br>
                            <div class="row">
                                <div class="col-sm-6 "><button type="button" class="btn btn-primary">Social Media</button></div>
                                <div class="col-sm-6 menu"><button type="button" class="btn btn-primary">Subscribe</button></div>

                            </div>






                        </div>
                    </div>
                </div>
            </div>








            <!--CARD SECTION ENDS HERE-->
            <br>
            <br>


            <!-- CHAT TEMPLELATE STARTS FROM HERE-->
            <div class="chat">
                <div class="row bot-says">

                    <!-- <div class="col-sm-1"> <img src="../assets/chat_bot.svg" alt="" style="width: 45px;float: right;"></div>
                    <div class="col-sm-5" style="background-color: #727AFF;border-radius: 12px;color: white;">

                        <p style="margin-top: 4px;">dsadas</p>


                    </div>
                    <div class="col-sm-6"></div>

                    <br> -->
                </div>



                <br>



                <div class="row user-says">



                    <!-- <div class="col-sm-6"></div>
                    <div class="col-sm-5" style="background-color: #727AFF; border-radius: 12px;color: white;">

                        <p style="margin-top: 4px;" id="input">
                            <script>
                                document.write(+text)
                            </script>

                        </p>


                    </div> 
                    <div class="col-sm-1"></div>-->


                </div>
            </div>
            <!-- CHAT TEMPLELATE ENDS HERE-->
            <br>
            <br>

            <!-- <div class="row" style="background-color: white; padding-top: 8px; padding-bottom: 8px; border-radius: 12px;;">
                <div class="col-sm-1"></div>
                <div class="col-sm-8">
                    <input type="text" style="width: 100%;border-radius: 8px;">
                </div>
                <div class="col-sm-2">
                    <input type="button" id="send-btn" value="Send" style="width:80%;border-radius: 8px;">
                </div>
                <div class="col-sm-1"></div>



            </div> -->
            <br>




        </div>
        <div class="row" style="background-color: white; padding-top: 8px; padding-bottom: 8px; border-radius: 12px;;">
            <div class="col-sm-1"></div>

            <div class="col-sm-8">

                <input type="text" name="user-input" id="hash" style="width: 100%;border-radius: 8px;">
            </div>
            <div class="col-sm-2">
                <div class="but-center"> <input type="button" class="send-btn" value="Send" style="width:80%;border-radius: 8px;"></div>

            </div>

            <div class="col-sm-1"></div>



        </div>

    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script src="ajaxcalls.js"></script>
    <script>
        $(".send-btn").click(function() {
            var text = $('#hash').val();


            $(".chat").append('<div class="row user-says"><div class="col-sm-6"></div><div class="col-sm-5" style="background-color: #727AFF; border-radius: 12px;color: white;"><p style="margin-top: 4px;" id="input">' + text + '</p></div><div class="col-sm-1"></div></div>');

            rettext = send(text);
            rettext = $('.andu').attr('id');
            console.log("Text Here --- "+rettext);
            $(".chat").append('<div class="row bot-says"><div class="col-sm-1"> <img src="../assets/chat_bot.svg" alt="" style="width: 45px;float: right;"></div><div class="col-sm-5" style="background-color: #727AFF;border-radius: 12px;color: white;"><p style="margin-top: 4px;">'+rettext+'</p></div><div class="col-sm-6"></div><br></div><br>');


            $('#hash').val('');
        });
    </script>








</body>

</html>